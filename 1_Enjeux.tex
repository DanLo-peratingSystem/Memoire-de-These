\ifdefined\included
\else
\documentclass[french, a4paper, 11pt, twoside, pdftex]{StyleThese}
\include{formatAndDefs}
\sloppy
\begin{document}
\setcounter{chapter}{1}
\dominitoc
\faketableofcontents
\fi

\chapter{Enjeux des systèmes à criticité multiple sur processeurs multi-c\oe{}urs}
\minitoc

La conception des systèmes embarqué, typiquement automobiles, a subit de fortes évolutions orientées vers de nouvelles fonctionnalités centrées sur le logiciel. Ces évolutions demandent des capacités de calcul de plus en plus importantes et donc des architectures matérielles pour supporter la demande grandissante en fonctionnalités. Par ailleurs le contexte industriel mène à la disparition des calculateurs d'antan, monoc\oe{}urs, pour se focaliser sur des calculateurs plus complexes et puissants, multic\oe{}urs. Cette tendance au multic\oe{}ur provient à la fois d'une limitation technologique et d'un besoin grandissant : la façon d'augmenter les capacités de calculs par les méthodes classiques (montée en fréquence) atteint ses limites et les capacités d'exécution concourante de logiciel est de plus en plus demandée dans un contextes aux contraintes financières et de time-to-market fortes. C'est ainsi que né la volonté de passer sur des architectures électriques et électroniques plus centralisées via l'utilisation d'une quantité d'unités de calcul réduite mais intégrant un plus grand nombre de fonctionnalités en leur sein. Cette volonté implique cependant une superposition des difficultés inhérentes aux architectures matérielles plus complexes avec les contraintes de sûreté de fonctionnement du logiciel. Nous faisons donc face à des systèmes à criticité mixte exécutés sur des calculateurs aux mécanismes complexes. Nous verrons donc dans ce chapitre quels sont les aspects essentiels de ce contexte et ses spécificités à prendre en compte pour proposer de nouveaux éléments de réponse dans la conception de systèmes à criticité mixte sur processeurs multic\oe{}urs. Nous concluront cette partie avec la présentation de la problématique à laquelle on tentera de répondre par la suite ainsi que la présentation des différents chapitres de contribution de cette thèse.

\section{Evolutions des Systèmes embarqués}
	\subsection{Nouveaux systèmes intelligents et connectés}
		Le contexte industriel actuel fait émerger de nouvelles technologies basées sur des logiciels de plus en plus complexes et performants. On retrouve ainsi un nombre grandissant de fonctionnalités directement embarquées dans l'automobile, l'avion, le train pour répondre à la fois à des besoins fonctionnels essentiels : assistance à la conduite/pilotage, tableaux de bord, etc. et des besoins de confort d'usage : info-divertissement, connectivité... 
		
		Si l'on prend l'exemple du domaine automobile, depuis près de 30 ans l'industrie n'a cessé de faire évoluer la façon de concevoir les véhicules et notamment leurs systèmes sous-jacents. Les voitures se sont modernisées avec l'ajout de calculateurs dédiés à des fonctions internes ou des services. Ainsi le développement des technologies de l'industrie 4.0 mène à une augmentation exponentielle du logiciel embarqué dans l'automobile au cours des 15 dernières années \cite{blanchet_industrie_2016}, avec la présence de plus de 60 calculateurs embarqués dans certains modèles. Les contrôles mécaniques et autres systèmes électriques cèdent la place au monde du numérique. Les équipements électroniques et logiciels se multiplient au sein du véhicule pour l’aide à la conduite (\textit{ADAS}) et l’ajout de services~\cite{schmidt_automotive_2010}.
		% le nombre de fonctionnalité d'aide à la conduite a explosé. 
		
		Ainsi, du simple Système Anti-blocage des roues (ABS), on a introduit des Assitants à la Conduite tel que le Freinage d'Urgence (\textit{Emergency Braking System}) ou encore le Système de Gestion de Ligne (\textit{Lane Support System}) qui permet à la fois l'Avertissement de Dépassement de Ligne (\textit{Lane Departure Warning}), l'Assistant de Maintient de Ligne (\textit{Lane Keeping Assist}) et le Maintien de Ligne d'Urgence (\textit{Emergency Lane Keeping})... et il ne s'agit là que de 2 fonctionnalités supplémentaires~! En parallèle, cette voiture qui devient de plus en plus automatisée voire autonome gagne aussi en connectivité avec la prise en compte de données extérieurs et un lien direct au cloud pour proposer une diversité de services : météo, divertissement, trafic routier etc.
		Les systèmes embarqués deviennent donc aussi connectés. Typiquement on parle de communications \emph{car-to-car} ou \emph{car-to-infrastructure}. Cette ouverture du système à son environnement est à double tranchant. D'une part cela offre de nouveaux horizons, avec des possibilités d'évolutivité simplifiée. Cela transforme la voiture en un concept de \textit{"Car-as-a-service"}, qui va pouvoir évoluer et se mettre à jour régulièrement à distance (\textit{Over-the-Air Updates}).
		
		On se dirige de cette façon vers un nouveau paradigme, où la voiture n'est plus un système mécanique sur lequel on adjoint du logiciel, mais à l'inverse un super-ordinateur multifonctionnel auquel on implante des roues et un moteur. Cette disruption apporte de nouveaux enjeux, notamment de sécurité, vie privée mais aussi sur la prédictibilité du système de par sa complexification. Cela fait donc évoluer les systèmes embarqués dans un environnement profondément à risques mais qui en plus s'accompagne de contraintes fortes.
		
		%%	Depuis près de 30 ans, l'industrie automobile n'a cessé de faire évoluer la façon de concevoir les véhicules et notamment leurs systèmes sous-jacents. Les voitures se modernisent de plus en plus avec l'ajout de calculateurs dédiés à des fonctions internes ou des services. Ainsi le développement des technologies de l'industrie 4.0 mène à une augmentation exponentielle du logiciel embarqué dans l'automobile au cours des 15 dernières années \cite{blanchet_industrie_2016}, avec la présence de plus de 60 calculateurs embarqués dans certains modèles. Les contrôles mécaniques et autres systèmes électriques cèdent la place au monde du numérique. Les équipements électroniques et logiciels se multiplient au sein du véhicule pour l’aide à la conduite et l’ajout de services~\cite{OD003}.
		
		%%	De plus les véhicules sont de plus en plus connectés. On parle de communications \emph{car-to-car} ou \emph{car-to-infrastructure}, qui ouvrent la voie aux systèmes automobiles distribués. Cette ouverture du système à son environnement est à double tranchant. D'une part cela offre de nouveaux horizons, avec des possibilités d'évolutivité simplifiée, mais d'autre part cela pose des problèmes de sécurité-immunité, et complexifie la prédictibilité comme on le verra dans cet état de l'art. Cela fait évoluer les systèmes embarqués dans un environnement profondément à risques. 
		
		
	\subsection{Enjeux industriels et économiques}
		Les enjeux industriels peuvent être variables selon les domaines. Ceci étant dit on peut nommer des éléments prépondérants, qui sont ceux que l'on va tenter de prendre en considération dans cette étude. La première d'entre elle est l'imposition de capacités de déploiement rapides (\textit{"Time-to-market" réduit}). Les itérations entre générations demandent des coûts de développement les moins importants possibles. Cela permet des cycles courts et réactifs qui s'adaptent aux évolutions technologiques. Cette contrainte industrielle est structurante sur les choix de conception, ce qui nous ramène souvent au principe "KISS", i.e. "Keep It Safe and Simple" dans notre cas. C'est une philosophie que j'ai souhaité maintenir le long de cette thèse afin de tenter une approche un peu différente des principales recherches actuelles qui tentent souvent d'aller dans des niveaux de détails toujours plus précis et complexes pour répondre aux difficultés technologiques. Comme on le verra plus tard, il existe ainsi des solutions très sophistiquées qui donnent de bons résultats théoriques, mais qui ne se sont pas généralisés dans un contexte industriel. Les question de complexité d'implémentation et simplicité de maintenance dans un cas réel semblent donc relativement déterminantes pour mesurer la pertinence d'une nouvelle contribution à la sûreté des systèmes embarqués.

		On pourra mentionner aussi des contraintes d'espace. Les systèmes embarqués ont une forte tendance à la miniaturisation pour des enjeux multiples. Cela permet des réductions de poids, essentiel pour des raisons évidents pour tous les systèmes volants (avions, drones) typiquement. Mais aussi pour rester dans les dimensions imposées pour l'automobile ou le ferroviaire encore. 
		
%	L'évolution future est de réduire le nombre de calculateurs embarqué, en passant d'un grand nombre d'ECU à un nombre bien plus réduit de "super ECU", qui vont multiplexer différentes tâches. On passe de cette façon d'un système distribué à un système fédéré basé sur des calculateurs multi-c\oe{}ur.  Là où ce type d'architecture va permettre de faciliter l'évolutivité, réduire les coûts et l'encombrement, vont apparaître d'autres problématiques auxquelles nous allons nous intéresser.

%	Historiquement, les calculateurs embarqués étaient conçus de manière \emph{ad hoc} : le hardware et le software étaient intimement liés. Cela a conduit à un nombre de calculateurs très important, chaque calculateur apportant sa fonctionnalité. On a donc actuellement une architecture avec un grand nombre d'ECU (Electronic Control Unit). On peut noter trois principales propriétés des systèmes embarqués automobiles :
%\begin{itemize}
%	\item Les ECU sont \emph{inter-connectés}, ils communiquent les uns avec les autres,
%	\item Les fonctions et services sont intégrés dans des sous-systèmes complexes. Ainsi un sous-système inclut divers fonctionnalités,
%	\item Les fonctions sont \emph{distribuées} sur plusieurs calculateurs. Certaines fonctions peuvent être hébergées par plusieurs micro-contrôleurs.
%\end{itemize} 
%Ce type d'architecture présentée ci-dessus a des inconvénients évidents en terme d'évolutivité du système et de temps de développement. A chaque changement de support physique (micro-contrôleur) le logiciel doit passer par un nouveau stade de développement plus ou moins conséquent. Inversement, une mise à jour du logiciel va demander une prise en compte du hardware. Cela augmente donc les temps et les coûts de développement.
			
\section{Architectures Matérielles}

 
    \subsection{Mono/Multi/Many Cores et GPU}
    \subsection{Architectures mémoires, cas des multi-c\oe{}urs}
	\subsection{Risques d'interférences}
	
\section{Criticité Mixte \& Contraintes Temporelles}
%	Les systèmes automobiles sont ainsi devenus des systèmes cyber-physiques qui entrent en interaction à la fois avec les utilisateurs et l'environnement. On distingue deux grands domaines de logiciels embarqués dans le véhicule. Tout d'abord l'\emph{infotainment}, qui réunit les systèmes multimédias et autres affichages non nécessaires à l'usage primaire du véhicule. Et deuxièmement les calculateurs enfouis qui réalisent des fonctions essentielles qui ne sont pas nécessairement visibles de l'utilisateur, telles que le contrôle moteur. 

%	Cela fait évoluer les systèmes embarqués dans un environnement profondément à risques. Au vu des fonctions réalisées, cela donne un poids prépondérant aux systèmes embarqués, qui se doivent de respecter des standards de sûreté élevés pour garantir leur fonctionnement. Cela va notamment se traduire par l'introduction des mécanismes de sûreté de fonctionnement, et par la prise en compte de contraintes temps-réel dans le développement de fonctions critiques.

%	Avec les architectures automobiles telles qu'elles évoluent actuellement se dessine un certain nombre de problématiques qui prennent de l'ampleur.   
%	Comme cela a été mentionné, les systèmes embarqués dans l'automobile sont soumis à des contraintes de sûreté fortes. Typiquement, des fonctionnalités qui étaient auparavant totalement décorrélées peuvent désormais se retrouver sur le même calculateur et interférer les unes avec les autres. Le multiplexage d'applications sur un calculateur puissant permet de réduire le nombre de micro-contrôleurs et de fait l'architecture matérielle. Dans ce contexte, similaire à celui de l'avionique, il faut mettre en place des mécanismes pour la conception, la vérification, la validation et la maintenance du logiciel. Que ce soit dans l'automobile ou l'avionique, on retrouve des similitudes sur les moyens employés. 
%	
%	Tout d'abord d'un point de vue des mécanismes de sûreté de fonctionnement, on distingue plusieurs catégories de fonctions logicielles, par niveau de criticité, pour un total de 5 niveaux de criticité allant d'un risque "catastrophique" pour les fonctions les plus vitales à "aucune conséquence" pour les fonctions les moins importantes. Pour l'automobile, il s'agit des niveaux d'ASIL (Automotive Safety Integrity Level) allant respectivement de l'ASIL~D à l'ASIL~A, et QM pour les fonctions sans exigence particulière. Selon ce niveau de criticité, les mécanismes mis en œuvre seront plus ou moins importants tout au long du processus de développement. Afin de garantir l'intégrité du système avec la coexistence de tâches à différents niveaux de criticité, un des grands principes est la séparation spatiale et temporelle des tâches au sein du calculateur (\emph{Time and Space Partitioning - TSP}). Spatiale car une tâche donnée aura son propre espace mémoire réservé, afin d'éviter toute interaction indésirable avec d'autres tâches. Temporelle afin de garantir que chaque tâche dispose de son temps d'exécution propre afin de garantir son bon fonctionnement. C'est suivant ce principe que dans le domaine de l'Avionique, le choix a été fait de cloisonner les tâches par l'utilisation du partitionnement. Ce partitionnement fixe va allouer à chaque tâche un espace mémoire prédéfini ainsi que des cœurs sur lesquels s'exécuter. Et pour les aspects temporels, il s'agit d'un ordonnancement \emph{statique}.
%	Dans le cadre des systèmes automobiles, cette solution n'est pas satisfaisante en raison de contraintes budgétaires fortes. Les avancées sur la connexion de la voiture au monde ouvert (notamment pour permettre des mises-à-jour \emph{Over-The-Air}) nous impose presque naturellement de rechercher des stratégies de partitionnement \emph{dynamique}. De cette façon, il sera possible de faire évoluer le logiciel embarqué en réduisant au maximum les coûts.
%	
%	Cependant, cette solution présente de nombreux défis pour être viable. De fait il y a un équilibre à trouver entre dynamicité et prédictibilité des systèmes embarqués, pour permettre leur exécution dans des conditions sûres de fonctionnement et notamment dans le respect des contraintes temporelles.
    \subsection{Enjeux des usages des multi-c\oe{}urs avec contraintes temporelles}
    \subsection{Problématique :  criticité multiple : comment optimiser l'usage des ressources avec garanties temporelles}
    
    
%% transition - présentation contenu État de l'Art %%


\ifdefined\included
\else
\bibliographystyle{StyleThese}
\bibliography{these}
\end{document}
\fi
